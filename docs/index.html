<!DOCTYPE html>
<html>
  <head>
    <title>Types vs Tests</title>
    <meta charset="utf-8">
    <style>
      @import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
      @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body { font-family: 'Droid Serif', 'Helvetica'; }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz', 'Gill Sans';
        font-weight: normal;
      }
      .pull-left {
      float: left;
      width: 47%;
      }
      .pull-right {
      float: right;
      width: 47%;
      }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono', 'Consolas', 'Courier New'; }
    </style>
  </head>
  <body>
    <textarea id="source">

class: center, middle

# Types vs Tests
`@JulienTruffaut`

---
class: center, middle

# Types

---
background-image: url(img/types-1.jpg)

# Types

---
background-image: url(img/types-2.jpg)

# Types

---
# Types


```scala
val x: Int = 5

val foo: String = "Hello World"
```

--

```scala
scala> val x: Int = "Hello World"
<console>:12: error: type mismatch;
 found   : String("Hello World")
 required: Int
       val x: Int = "Hello World"
                    ^
```

---
background-image: url(img/function.jpg)

# Functions

---
# Functional programming subset

* not nondeterministic (deterministic)
* not partial (total)
* no side effect
* no mutation
* no exception
* no null
* no reflection

---
# Statically typed function

```scala
def increment(x: Int): Int = x + 1
```

--

```scala
scala> increment(2)
res0: Int = 3
```

--

```scala
scala> increment(1.1)
<console>:14: error: type mismatch;
 found   : Double(1.1)
 required: Int
       increment(1.1)
                 ^

scala> increment("hello")
<console>:14: error: type mismatch;
 found   : String("hello")
 required: Int
       increment("hello")
                 ^
```

---
class: center, middle

# Tests

---
class: center, middle

# Unit Test

---
# Unit Test

```scala
increment( 0) ==  1
increment( 1) ==  2
increment(-3) == -2
```

---
background-image: url(img/increment-math-unit-test-1.jpg)

# Unit Test

---
background-image: url(img/increment-math-unit-test-fail.jpg)

# Unit Test

---
background-image: url(img/increment-math-unit-test-2.jpg)

# Unit Test

---
class: center, middle

# Property Test

---
# Property Test

```scala
import org.scalacheck.Prop.forAll

forAll { (x: Int) => increment(x) > x }
```

---
background-image: url(img/increment-math-property-test-1.jpg)
# Property Test

---
background-image: url(img/increment-math-property-test-2.jpg)
# Property Test

---
background-image: url(img/increment-math-property-test-fail.jpg)
# Property Test

---
background-image: url(img/increment-math-property-test-3.jpg)
# Property Test

---
class: center, middle

# Types and Tests?

---
# Untyped language (Javascript)

```javascript
function increment(x){
  return x + 1;
}
```

--

```javascript
increment(2)
3
```

--

```javascript
increment(1.1)
2.1
```

--

```javascript
increment("hello")
"hello1"
```

--

```javascript
increment('c')
"c1"
```

---
# Typed language (Scala)

```scala
def increment(x: Int): Int = x + 1
```

--

```scala
scala> increment(1.1)
<console>:15: error: type mismatch;
 found   : Double(1.1)
 required: Int
       increment(1.1)
                 ^

scala> increment("hello")
<console>:15: error: type mismatch;
 found   : String("hello")
 required: Int
       increment("hello")
                 ^
```

---
class: center, middle

# Types constrain the implementation such as we have less tests to write

---
class: center, middle

# How much?

---
class: center, middle

# Are all types equals?


---
background-image: url(img/types-1.jpg)

# Types

---
class: center, middle

# A => B

---
background-image: url(img/int-to-int-type-1.jpg)

# Functions have types!

---
background-image: url(img/int-to-int-type-2.jpg)

# Functions have types!

---
background-image: url(img/int-to-int-type-test-1.jpg)

# Unit test

---
background-image: url(img/int-to-int-type-test-2.jpg)

# Fully tested function

---
background-image: url(img/int-to-int-type-test-3.jpg)

# Compromise

---
background-image: url(img/function.jpg)

# Function is a mapping

---
background-image: url(img/function-mapping-1.jpg)

# Function is a mapping

---
background-image: url(img/count-A-to-B-1.jpg)

# |A => B|

---
background-image: url(img/count-A-to-B-2.jpg)

# |A => B|

---
background-image: url(img/count-A-to-B-3.jpg)

# |A => B|

---
background-image: url(img/count-A-to-B-4.jpg)

# |A => B|

---
class: center, middle

# |A|


---
# |Boolean|

--

```haskel
data Boolean = True | False
```

--

```scala
|Boolean| = 2
```

---
# |Unit|

--

```scala
case object Unit
```

```scala
scala> Unit
res9: Unit.type = object scala.Unit
```

--

```scala
scala> ()
```

--

```scala
|Unit| = 1
```

---
# |Char|

--

```scala
scala> 'a'
res11: Char = a

scala> '8'
res12: Char = 8

scala> ';'
res13: Char = ;
```

--


`Char` encodes characters with 8 bits, so

```scala
|Char| = 2^8 - 1 == 255
```

---
# |Option[Unit]|

```scala
Option[Unit] = None | Some(())
```

--

```scala
|Option[Unit]| = 2
```


---
# |Option[Boolean]|

```scala
Option[Boolean] = None | Some(true) | Some(false)
```

--

```scala
|Option[Boolean]| = 3
```

---
# BooleanOrChar

```scala
sealed trait BooleanOrChar
object BooleanOrChar {
  case class B(x: Boolean) extends BooleanOrChar
  case class C(x: Char) extends BooleanOrChar
}
```

--

```scala
BooleanOrChar = Boolean | Char
```

--

```scala
|BooleanOrChar| = |Boolean| + |Char|
                = 2 + 255
                = 257
```

---
# |(Boolean, Unit)|

```scala
(Boolean, Unit) = (true, ()) | (false, ())
```

--

```scala
|(Boolean, Unit)| = 2
```

---
# |(Boolean, Char)|

--

```scala
(Boolean, Char) = (true, x: Char) | (false, x: Char)
```

--

```scala
|(Boolean, Char)| = 2 * |Char|
                  = 2 * 255
                  = 510
```

---
# Id

```scala
case class Id[A](id: Char, value: A)
```

--

```scala
Id[A] = (c: Char, a: A)
```

--

```scala
|Id[A]| = |Char| * |A|
        = 255    * |A|
```

---
class: center, middle

# Thanks!
Code and slides at `julien-truffaut/types-vs-tests` on GitHub

## Questions?


 </textarea>
    <script src="https://remarkjs.com/downloads/remark-latest.min.js">
    </script>
    <script>
        var slideshow = remark.create({
            ratio: "16:9"
        });
    </script>
  </body>
</html>
